{% extends 'layout/base.html' %}
{% load i18n %}

{% block title %}{{ object.name }}{% endblock %}

{% block content %}
<section class="category-detail">
    <div class="container">
        <div class="breadcrumbs">
            <small><a href="{% url 'home' %}">{% trans "Home" %}</a></small> > <small><a href="{{ object.category.get_absolute_url }}">{% trans "View more articles in" %} {{ object.category.name }}</a></small> > {{ object.name|truncatechars:30 }}
        </div>
        <h1>
            {{ object.name }}
            <small>{% trans "Last updated" %} {{ object.updated_at }}</small>
        </h1>
        {% if object.is_private %}
        <blockquote>{% trans "This is private article. Only authenticated users can see it." %}</blockquote>
        {% endif %}
        <article>
            {{ object.content_markdown|safe }}
        </article>
        {% if voted_article_list not in request.session or object.id not in request.session.voted_article_list %}
        <div class="vote-buttons">
            <ul>
                <li class="vote-up">
                    <button type="button">{% trans "It worked for me" %}</button>
                </li>
                <li class="vote-down">
                    <button type="button">{% trans "It was not helpful" %}</button>
                </li>
            </ul>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
$(document).ready(function () {
    // Upvote
    $('div.vote-buttons li.vote-up').click(function () {
        $.get("{% url 'article_upvote' object.category.slug object.slug %}", function(response) {
            $('li.vote-up').addClass('selected');
            $('li.vote-down button').prop('disabled', true);
        });

        return false;
    });

    // Downvote
    $('div.vote-buttons li.vote-down').click(function () {
        $.get("{% url 'article_downvote' object.category.slug object.slug %}", function(response) {
            $('li.vote-down').addClass('selected');
            $('li.vote-up button').prop('disabled', true);
        });

        return false;
    });
});
</script>
{% endblock %}
